{% extends "base.html" %}
{% load static %}
{% load widget_tweaks %}

{% block title %}Africana AI | Secure Registration{% endblock %}

{% block content %}
<main class="min-h-screen bg-[#02040a] font-sans antialiased text-slate-300 py-12 px-4 selection:bg-indigo-500/30">
    <div class="fixed inset-0 bg-[radial-gradient(circle_at_50%_0%,_rgba(79,70,229,0.08),transparent_50%)] pointer-events-none"></div>

    <div class="relative max-w-xl mx-auto">
        <div class="text-center mb-10">
            <div class="inline-flex items-center justify-center w-16 h-16 rounded-3xl bg-indigo-500/10 border border-indigo-500/20 mb-6 shadow-2xl shadow-indigo-500/10">
                <svg class="w-8 h-8 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"/>
                </svg>
            </div>
            <h1 class="text-4xl font-bold text-white tracking-tighter mb-3">Create Account</h1>
            <p class="text-[10px] text-slate-500 font-bold uppercase tracking-[0.4em]">Secure Node Initialization</p>
        </div>

        <div class="bg-white/[0.02] border border-white/10 rounded-[40px] p-8 md:p-12 backdrop-blur-3xl shadow-2xl relative overflow-hidden">
            <div class="absolute top-0 right-0 p-6 opacity-20">
                <svg class="w-12 h-12 text-indigo-500" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2L1 21h22L12 2zm0 3.45l8.27 14.3H3.73L12 5.45zM11 16h2v2h-2v-2zm0-7h2v5h-2V9z"/></svg>
            </div>

            <form method="post" class="space-y-6" id="registrationForm">
                {% csrf_token %}

                {% for field in form %}
                    <div class="relative group">
                        <label class="block text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2 ml-1 group-focus-within:text-indigo-400 transition-colors">
                            {{ field.label }}
                        </label>
                        
                        <div class="relative">
                            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 group-focus-within:text-indigo-500 transition-colors">
                                {% if "user" in field.label.lower %}<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" stroke-width="2"/></svg>
                                {% elif "email" in field.label.lower %}<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" stroke-width="2"/></svg>
                                {% else %}<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" stroke-width="2"/></svg>
                                {% endif %}
                            </div>

                            {{ field|add_class:"w-full bg-white/[0.03] border border-white/10 rounded-2xl py-4 pl-12 pr-4 text-sm text-white outline-none focus:border-indigo-500/50 focus:bg-indigo-500/5 transition-all duration-300 placeholder-slate-700" }}
                        </div>

                        {% if "password" in field.label.lower and "confirm" not in field.label.lower %}
                        <div id="password-requirements" class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-2 p-4 bg-black/20 rounded-2xl border border-white/5">
                            <div class="req-item flex items-center gap-2 text-[10px] text-slate-500 transition-colors" id="length">
                                <div class="w-1.5 h-1.5 rounded-full bg-slate-700 dot"></div> 8+ Characters
                            </div>
                            <div class="req-item flex items-center gap-2 text-[10px] text-slate-500 transition-colors" id="complexity">
                                <div class="w-1.5 h-1.5 rounded-full bg-slate-700 dot"></div> Not commonly used
                            </div>
                            <div class="req-item flex items-center gap-2 text-[10px] text-slate-500 transition-colors" id="alpha">
                                <div class="w-1.5 h-1.5 rounded-full bg-slate-700 dot"></div> Not entirely numeric
                            </div>
                            <div class="req-item flex items-center gap-2 text-[10px] text-slate-500 transition-colors" id="personal">
                                <div class="w-1.5 h-1.5 rounded-full bg-slate-700 dot"></div> Unique to you
                            </div>
                        </div>
                        {% endif %}

                        {% if field.errors %}
                            {% for error in field.errors %}
                                <p class="text-[10px] text-red-400 mt-2 ml-1 flex items-center gap-1 italic">
                                    <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z"/></svg>
                                    {{ error }}
                                </p>
                            {% endfor %}
                        {% endif %}
                    </div>
                {% endfor %}

                <div class="pt-6">
                    <button type="submit" class="w-full py-5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-2xl font-bold text-[10px] uppercase tracking-[0.3em] transition-all duration-500 shadow-xl shadow-indigo-600/20 active:scale-[0.98]">
                        Register
                    </button>
                </div>
            </form>

            <div class="mt-10 pt-8 border-t border-white/5 text-center">
                <p class="text-xs text-slate-500 mb-4">
                    Already a member? 
                    <a href="{% url 'users:user_login' %}" class="text-white font-bold hover:text-indigo-400 transition-colors ml-1">Log in here</a>
                </p>
                <div class="flex justify-center items-center gap-4 opacity-40">
                    <span class="text-[8px] uppercase font-black tracking-widest">SSL Secure</span>
                    <div class="w-1 h-1 rounded-full bg-slate-700"></div>
                    <span class="text-[8px] uppercase font-black tracking-widest">AES-256 Encrypted</span>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
    // Modern Password Validation Logic
    const passwordInput = document.querySelector('input[type="password"]');
    const reqItems = {
        length: document.getElementById('length'),
        alpha: document.getElementById('alpha'),
        complexity: document.getElementById('complexity'),
        personal: document.getElementById('personal')
    };

    if (passwordInput) {
        passwordInput.addEventListener('input', (e) => {
            const val = e.target.value;
            
            // 1. Length check
            updateReq(reqItems.length, val.length >= 8);
            
            // 2. Not entirely numeric
            updateReq(reqItems.alpha, /[a-zA-Z]/.test(val));
            
            // 3. Complexity & Common (Mock logic for UI feel)
            updateReq(reqItems.complexity, val.length > 0 && !['password', '12345678'].includes(val.toLowerCase()));
            
            // 4. Similarity check (Visual hint)
            updateReq(reqItems.personal, val.length > 4);
        });
    }

    function updateReq(el, isValid) {
        if (!el) return;
        const dot = el.querySelector('.dot');
        if (isValid) {
            el.classList.remove('text-slate-500');
            el.classList.add('text-green-400');
            dot.classList.replace('bg-slate-700', 'bg-green-400');
        } else {
            el.classList.add('text-slate-500');
            el.classList.remove('text-green-400');
            dot.classList.replace('bg-green-400', 'bg-slate-700');
        }
    }
</script>

<style>
    /* Premium Input Interaction */
    input {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    input:focus {
        box-shadow: 0 0 25px rgba(79, 70, 229, 0.15);
    }

    /* Modern Autofill Handling */
    input:-webkit-autofill {
        -webkit-text-fill-color: white !important;
        -webkit-box-shadow: 0 0 0px 1000px #0d0f14 inset !important;
    }

    .req-item {
        transition: all 0.3s ease;
    }

    @keyframes successPop {
        0% { transform: scale(1); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
    }

    .text-green-400 .dot {
        animation: successPop 0.3s ease-out;
    }
</style>
{% endblock %}